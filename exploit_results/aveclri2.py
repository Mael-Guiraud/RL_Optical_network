import pandas as pd

# Chargement des fichiers
df1 = pd.read_csv("stats_glob_s_min_merged.csv")
df2 = pd.read_csv("lri2.csv")

# Extraction du numéro d'instance depuis "iX"
df1["instance_num"] = df1["instance"].str.extract(r"i(\d+)").astype(int)

# Filtrage : on garde uniquement i1 à i99
df1 = df1[(df1["instance_num"] >= 1) & (df1["instance_num"] <= 99)]

# Filtrage du second fichier (par sécurité)
df2 = df2[(df2["Test"] >= 1) & (df2["Test"] <= 99)]

# Jointure
df_merged = df1.merge(
    df2[["Test", "POLY", "POLYOPTI", "LRI"]],
    left_on="instance_num",
    right_on="Test",
    how="left"
)

# Nettoyage
df_merged = df_merged.drop(columns=["instance_num", "Test"])

# Sauvegarde
df_merged.to_csv("nouveau_fichier.csv", index=False)
